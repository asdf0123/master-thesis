\chapter{引言}\label{chap:introduction}{
	\section{研究背景与意义}
	双界面商用智能卡具有开阔的发展前景以及广泛的应用环境。因此，它的密码安全性成为学术界与产业界关注的焦点。
	
	在2022年，全球智能卡市场已达到142.3亿美元的规模。而根据预测，自2023年起至2030年，市场的复合年增长率将达到5.7\%\citep{GVR-1-68038-464-2}。预计到2030年时，智能卡市场的规模将扩展至217.3亿美元。这种明确的趋势反映出，人类对于同时兼备安全性和便捷性的支付系统的需求在逐年升温，而对于高效强大的身份识别和认证方式的追求也日益增强。在这背景下，作为门禁控制、安全登陆程序以及数字签名等各类重要工具的智能卡，正在全球范围内发挥着其重要角色，广泛应用于身份识别和认证领域。随着各行各业对身份验证措施的要求日趋严格，预期智能卡的需求将出现大幅度增长。
	
	双界面智能卡是一种带有微处理器和存储器等微型集成电路芯片的、具有标准规格的功能强大且广泛使用的智能卡。它有金属接触和射频接口，兼具接触式卡和非接触式卡的通信功能，可以与多种终端设备进行交互。双界面智能卡的广泛应用范围涵盖了多个关键行业，包括金融、交通、物流、电子支付等领域。在金融领域，双界面智能卡可用于银行卡、信用卡和电子钱包等支付工具。它能够与销售终端（Point of Sales， POS）和自动取款机甚至移动电话进行交互，实现安全的支付和身份验证功能。在交通和物流领域，双界面智能卡被广泛应用于门禁系统、地铁票务系统、高速公路收费系统等。它能够快速、便捷地进行身份验证和票务管理，提高交通运输的效率和安全性。此外，双界面智能卡还在电子身份证、电子护照、企业门禁控制和无线通信等领域发挥着重要作用。它的灵活性和可靠性使其成为智能化社会中各种商用安全应用的首选技术。总的来说，双界面智能卡凭借其广泛的应用领域和卓越的安全性能，成为了当今智能卡技术的重要组成部分，为各行各业的安全交互提供了可靠的解决方案。
	
	尽管算法在理论上足够安全，但是在实际密码硬件单元中密码算法实现还可能受到物理分析的威胁。物理分析包括侧信道分析、故障注入分析\citep{Biham97}及逆向工程\citep{Perrin17}等多种手段。在众多的物理分析方法中，侧信道分析因其不需要干预程序的正常执行而具有较大的危害。此时系统的安全性就不仅依赖于算法和协议的安全性，还依赖于算法和协议的安全实现。实际应用中，密码芯片运行时会具有某种特定的物理特征，而这些特征会泄漏内部状态，分析人员可以利用这些信息泄漏破译密码系统内部的秘密信息，甚至会破译出密码系统内部的某些秘密算法或者密码结构，因而对密码系统的实际安全性造成极大威胁。利用这类信息泄漏的密码分析方法称为侧信道分析（Side-channel Analysis，SCA）或侧信道攻击（Side-channel Attack），而被利用的信息泄漏被称为侧信息。在密码系统的实际应用场景下，攻击者除了可以获得传统黑盒密码分析模型下可以获得的密码算法的输入与输出，还可以观测到多种有益于密码分析的侧信息泄漏。在2020年，Camurati等\citep{Camurati20}只使用无线电信号恢复使用\textit{Google Eddystone}\citep{Eddystone}协议的小型低功耗设备的高级加密标准（Advanced Encryption Standard， AES）的密钥，进而通过认证。在2021年，Roche等\citep{Roche21}通过侧信道分析可以获取谷歌安全产品\textit{Google Titan Security Key}\citep{Titan}的签名私钥进而伪造签名。{\color{\xchange}可以看出，侧信道分析对密码系统的实际安全性造成极大威胁。}
	
	%侧信道分析的威胁已经得到了重视。
	
	%在政策层面，
	为了应对这种威胁并提高密码硬件单元的安全性，国内外的主流标准化组织和密码测评部门提出了具体的安全性要求和侧信道分析流程。例如，美国的FIPS 140-3标准\citep{FIPS140-3}和ISO/IEC 19790\citep{ISO/IEC19790}国际标准将硬件单元在侧信道攻击下的安全性作为重要要求。而ISO/IEC 17825\citep{ISO/IEC17825}国际标准则更加详细地对密码硬件单元在侧信道攻击下的安全性以及防护能力进行了概要性等级划分。此外，国际标准Common Criteria\citep{CCMB-2017-04-001}根据物理安全性定义了EAL1-EAL7，它们分别对应七个不同的安全级别。而中国国家密码管理局制定的《安全芯片密码检测准则》GM/T 0008-2012\citep{GM/T0008}、《密码模块安全技术要求》MG/T 0028-2014\citep{GM/T0028}以及《密码模块非入侵式攻击缓解技术指南》GM/T 0083-2020\citep{GM/T0083}则明确规定了密码模块必须具备针对抵御典型的侧信道攻击（如能量分析攻击、电磁分析攻击和计时攻击等）的安全防护能力。以上标准和准则的出台，为增强密码硬件系统抵御侧信道分析的能力提供了明确的指导，并对密码硬件单元的安全性进行了全面考量。
	
	%在商业领域，
	同时，知名芯片公司纷纷将增强抵御侧信道分析的能力作为确保产品物理安全性的重要手段。例如，2018年，Intel公司主动公开了预测执行侧信道缓存计时漏洞L1终端故障（L1 Terminal Fault，L1TF），并同时公布了完整的防御措施\citep{L1TF}。为抵御类似风险，Intel公司还在硬件层面进行了相应改进\citep{AffectedProcessors}。2019年，Xilinx公司加强了其Zynq UltraScale+系列产品的抵御侧信道分析能力，该产品集成了RSA认证加密机制和密钥刷新方案以抵御差分能量攻击和选择明文攻击\citep{UG1085}。AMD公司在2023年更新CPU微代码以防范了通过侧信道泄漏特权信息的Inception漏洞\citep{AMD-SB-7005}。
	
	可以看出，在国内外主流标准化组织、密码测评部门以及芯片公司中，抵御侧信道分析的能力被视为评估密码硬件单元安全性的重要指标之一。进行侧信道安全检测的主要方法为“攻击驱动”，需要系统地尝试各种侧信道分析方法，以判断其能否对密码产品的安全性构成威胁\citep{ISO/IEC15408, GB/T18336}。确保密码硬件单元物理安全性检测评估结果的准确性和可靠性，高度依赖于所使用的先进、高效的侧信道分析方法。因此，为确保密码硬件单元物理安全性评估体系的准确性、可靠性和前沿性，有必要持续深入研究并发展先进、高效的侧信道分析方法。这将有助于改善和提升密码硬件单元信息泄漏分析和物理安全性测评的技术能力，并对建立先进的密码硬件单元物理安全性评估体系具有重要意义。
	
	在实际应用中，侧信道分析的效果受多种因素制约{\color{\xchange}，如样本不足、敏感信息泄漏信号质量低}。
	
	攻击者可能因为样本不足导致侧信道分析失败。在能量迹、电磁迹充足的情况下，如分析AES\_RD\citep{AESRD}、AES\_HD\citep{AESHD}、DPA v4\citep{dpav4}、ASCADf\citep{Benadjila20}等公开数据集时，分析人员可以使用充足的数据较为准确地刻画泄漏模型，进而完成设备密钥的恢复。但是在一些重要的密码应用场景中，设计人员通常使用多种防护方案对攻击者获得侧信道分析的样本进行限制。如VMware公司为了提高ESXi主机安全性会激活锁定模式，在锁定模式下需要用智能卡验证才能完成ESXi主机的登录。在连续多次验证失败后，智能卡上的芯片将锁定。如果智能卡已锁定，则只有选定人员才能将其解锁\citep{GUID-04636353-4A11-4874-9D59-7F4F4E5CF1F}。锁定模式使得不知道密钥的攻击者需要在样本不足，即只能采集极少的智能卡验证过程中的能量迹、电磁迹的情况下完成侧信道分析。Xilinx公司Zynq UltraScale+产品的滚动密钥(Key Rolling)方案明确限定了密钥的使用次数\citep{UG1085}，滚动密钥用于解密配置FPGA的比特流。滚动密钥方案使得相同密钥值的使用次数受限，攻击者采集到的对应了相同密钥的能量迹、电磁迹也会不足。除此之外，攻击者获取能量迹、电磁迹的速度还受算法实现执行速度的限制，如针对智能卡上RSA-1024签名过程，需要约1秒才能采集一条能量迹。在这种条件下，攻击者因为采集时间和存储空间有限而很难获取并使用大量数据刻画泄漏模型。在样本不足的情况下，侧信道分析的技术效果会因为建模数据量受限而严重下降，进而无法成功恢复密钥。%能量迹、电磁迹是侧信道攻击流程中的关键要素，因此减少攻击成功时所使用的能量迹、电磁迹条数是提升侧信道攻击的效果的重要方面。
	%它们的数量能对侧信道攻击的效果产中严重影响。在能量迹、电磁迹充足的情况下，如分析AES\_RD\citep{AESRD}、AES\_HD\citep{AESHD}、DPA v4\citep{dpav4}、ASCADf\citep{ASCAD}等公开数据集时，分析人员可以使用充足的数据较为准确地刻画泄漏模型，进而完成设备密钥的恢复。但是在一些重要的密码应用场景中，设计人员通常使用多种防护方案对攻击者获得侧信道攻击的样本进行限制。如VMware为了提高ESXi主机安全性会激活锁定模式，在连续多次验证失败后，智能卡上的芯片将锁定。如果智能卡已锁定，则只有选定人员才能将其解锁\citep{GUID-04636353-4A11-4874-9D59-7F4F4E5CF1F}。Zynq UltraScale+的滚动密钥(Key Rolling)明确限定了密钥的使用次数\citep{UG1085}。除此之外，攻击者获取能量迹、电磁迹的速度还受算法实现执行速度的限制，如针对智能卡上RSA-1024签名过程，需要约1s才能采集一条能量迹。在这种条件下，攻击者很难获取并使用大量数据刻画泄漏模型。在样本不足的情况下，侧信道分析的技术效果会因为建模数据量受限而严重下降，进而无法成功恢复密钥。因此，探讨样本数量有限情况下的提升侧信道攻击效果的方法，具有重要的现实意义。
	
	%存在的问题
	%攻击者可能因为成本过高而无法实施侧信道分析。在攻击一款双界面商用智能卡（见\secref{sec:vulnerable}）时，电磁迹具有采样点多特征点少、特征点特征不明显、特征点分散等特点，深度学习模型的池化层提取敏感信息泄漏特征时无法同时达到尽可能排除非特征点、高效和准确的需求，从而无法实施侧信道分析。当排除的非特征点较少，电磁迹的采样点个数仍然较多，以现有的计算资源无法构造可行的深度学习模型；当池化层提取敏感信息泄漏特征低效，进行深度学习侧信道分析（Deep-learning based Side-channel Attack， DL-SCA）的时间开销难以承受；当池化层提取敏感信息泄漏特征不准确，深度学习模型所使用的样本本身就存在大量错误，这会导致侧信道分析失败。
	
	%因此，挖掘所攻击算法实现的可用于攻击的数学结构模块或特殊结构，研究DL-SCA在现实场景的应用问题，减少攻击所使用的能量迹、电磁迹数量，具有重要的现实意义。本研究以提升对一类双界面商用智能卡的侧信道分析方法的技术效果为最终目标，从减少攻击成功时所使用的能量迹、电磁迹条数的角度出发，开展两个阶段的侧信道分析研究：以多种AES算法实现为研究目标的通用数据增强方法效果量化研究、以一类双界面商用智能卡上椭圆曲线数字签名算法（Elliptic Curve Digital Signature Algorithm， ECDSA）实现为研究目标的侧信道分析实证研究。
	
	{\color{\xchange} 
		
	攻击者可能因为敏感信息泄漏信号质量低导致侧信道分析失败。为了攻击一款双界面商用智能卡椭圆曲线数字签名算法（Elliptic Curve Digital Signature Algorithm， ECDSA）实现（见\secref{sec:vulnerable}），需要使用深度学习侧信道分析（Deep-learning based Side-channel Attack， DL-SCA）恢复敏感信息泄漏，然后运用格方法才能恢复ECDSA私钥。采集到的电磁迹存在采样点多、特征点特征不明显的问题，这是由双界面商用智能卡本身的物理特性以及采集环境共同导致的，但是以现有技术难以提升采集到的电磁迹的信号质量。电磁迹采样点多导致深度学习模型训练时间长，以本文使用的深度学习模型和实验环境为例，执行DL-SCA的训练阶段理论上需要315天。电磁迹特征点不明显导致DL-SCA技术效果差，在可接受范围内进行DL-SCA恢复敏感信息泄漏的结果类似于随机猜测，进一步导致运用格方法恢复ECDSA私钥的时间达到约$2\times10^{85}$年，远超过现实场景可接受的范围。
	
	为了解决这些问题，需要研究DL-SCA在现实场景的应用问题，挖掘当前ECDSA实现可用于攻击的数学模块或特殊结构，将攻击的总时间减小到可接受的范围内。本研究以提升对一类双界面商用智能卡的侧信道分析方法的技术效果为最终目标，从\jiaodu 出发，开展两个阶段的侧信道分析研究：以多种AES算法实现为研究目标的通用数据增强方法效果量化研究、以一类双界面商用智能卡上ECDSA实现为研究目标的侧信道分析实证研究。
	}
	
	%\$\{研究内容1\}
	%深度学习在许多时间序列分析任务中表现出色。深度神经网络的卓越性能在很大程度上依赖于大量的训练数据，以避免过拟合。然而，现实世界中许多时间序列应用的标注数据可能是受限的，如采样密码设备获得的能量迹因为多次验证失败后加密模块会被锁定、采集时间受限等原因限制加密算法执行次数。作为提高训练数据规模和质量的有效方法，数据增强对成功应用深度学习模型到时间序列数据上显得至关重要。
	在以多种AES算法实现为研究目标的通用数据增强方法方面，本文重点研究将深度学习与数据增强结合，减小攻击成功所需的能量迹条数。DL-SCA是一类强大的侧信道分析方法，它无需对齐、压缩等预处理技术就可以实现敏感信息泄漏特征的精确刻画。自2016年起，已有大量工作\citep{Maghrebi16,Cagli17,Zaid20,Wouters20,Wu22}说明了基于深度学习的侧信道分析技术的可行性以及巨大潜力。然而，DL-SCA通常需要大量数据、强大算力等条件完成模型的训练，在上述条件难以满足或未能全部满足时，检测精度差、分析成功率低等问题便会凸显出来，严重地影响实际攻击效果。数据增强（Data Augmentation， DA）方法可以在不增加样本数量的前提下，利用采集到的样本增广新的样本，增加数据的数量和多样性\citep{Krizhevsky12,Simard03}，在训练阶段提升深度学习模型的泛化能力，在测试阶段提升DL-SCA的技术效果。因此，采用数据增强方法构建更加准确的模型，从而减少攻击成功所需的数据量，是提升DL-SCA技术效果的一种有效的技术思路。虽然已有研究工作\citep{Cagli17,Pu17,Kim19,Picek19,Won20,Luo21,Mukhtar22}使用位移变形和添加删除变形、循环位移变形、添加噪声、合成少数类过采样法（Synthetic Minority Over-Sampling Technique， SMOTE）\citep{Chawla02}、混淆（Mixup）\citep{Zhang17}、条件生成对抗网络和连体网络等多种技术实现数据增强，向训练集中添加人工合成的样本以提升DL-SCA技术效果，但是它们通常只适用于特定种类侧信道分析数据集，且实际攻击中还存在数据增强策略参数选择方法不明确，数据增强效果有限等技术挑战。因此, 开展以多种AES算法实现为研究目标的通用数据增强方法研究，设计出一个适用于多种算法实现的通用数据增强方法，自适应地选择数据增强策略参数对于提升DL-SCA的适用性具有重要意义。
	
	%\$\{研究内容2\}
	在以一类双界面商用智能卡上ECDSA实现为研究目标的侧信道分析方面，本文以分析型号为J3D081的双界面商用智能卡为例，开展面向基于深度学习侧信道分析数据增强方法应用实例研究，提升了将侧信道分析与格方法结合的情况下在ECDSA实现分析场景中的技术效果。将双界面商用智能卡作为攻击目标为侧信道分析带来一定难度，因为双界面智能卡相对于接触式智能卡、非接触式智能卡更为复杂，对于能量迹、电磁迹的采集和处理有更高的技术要求。就ECDSA而言，侧信道分析方法和防御措施不断演进，因此侧信道分析方法和防御措施多样。例如，常数时间算法被用于防御计时攻击\citep{Kocher96}和针对特定点的攻击\citep{Sato04}，随机曲线同构\citep{Joye01}被用于防御计时攻击\citep{Kocher96}和水平攻击\citep{Clavier10}，点盲化\citep{Coron99}被用于防御计时攻击\citep{Kocher96}、水平攻击\citep{Clavier10}和针对特定点的攻击\citep{Sato04}，随机化初始点\citep{Mamiya04,Abidalrahman10,Tawalbeh16}被用于防御地址比特差分能量分析\citep{Itoh02}和相关能量分析\citep{Coron99}，窗口算法\citep{Reddy11}被用于防御倍点攻击\citep{Fouque03}。现有对ECDSA进行侧信道分析的研究也仅仅以某种特定的实现作为研究目标，例如Perin等\citep{Perin20}以特定算法库$\mu$NaCl\footnote{$\mu$NaCl \href{http://munacl.cryptojedi.org/curve25519-cortexm0.shtml}{http://munacl.cryptojedi.org/curve25519-cortexm0.shtml}}在ARM Cortex-M平台上的实现为研究目标，同时结合无监督学习和深度学习进行侧信道分析；Diego等\citep{Diego20}以使用Montgomery 阶梯算法\citep{Cohen05,Blake05}实现标量乘法的ECDSA实现为研究目标，利用时间泄漏进行侧信道分析；Jin等\citep{Jin21}以固定底数的、使用基于查表的标量乘法的ECDSA在ARM Cortex-M平台上的实现选为研究目标，利用碰撞信息进行侧信道分析；Roche等\citep{Roche21}以谷歌安全产品\textit{Google Titan Security Key}\citep{Titan}上的具体实现未知的ECDSA为研究目标，使用无监督学习进行侧信道分析。可以看出尽管侧信道分析方法多样，但是当研究目标给定时，其算法实现不再变化，可能有效的侧信道分析方法是极少的，甚至没有。又由于商用密码芯片内嵌的防护措施通常作为机密受到保护使得进行攻击所需要的成本变高，例如攻击者在防护措施未知的情况下需要穷举可能防护措施并尝试攻击，这提高了侧信道分析的计算资源和时间开销。在成本过高的情况下，分析人员无法在可接受的攻击时间内使用大量数据进行侧信道分析，进而导致侧信道分析不能恢复密钥。因此，开展以一类双界面商用智能卡上ECDSA实现为研究目标的侧信道分析研究，有效降低侧信道分析与格方法结合时恢复ECDSA私钥的时间，对于提升智能卡测评技术具有重要意义。
	
	\section{国内外研究现状}
	
	%深度学习（Deep Learning, DL）使用深度神经网络，通过已有的信息或者知识来对未知事物进行预测。随着硬件算力的提升和可用数据的增加，深度学习技术近年来得到了迅速发展。在诸如图像分类、目标检测、语音识别、自然语言处理等领域，深度学习技术已经取得了远超统计和人工特征提取等传统方法的性能。
	自计时攻击\citep{Kocher96}和能量分析攻击\citep{KocherJJ99}这两个开创性工作提出至今，经过近二十八年的发展，侧信道分析已成为密码学研究的一个重要分支，受到国际学术界和产业界的广泛关注。本文以DL-SCA为主要分析方法，从数据增强的角度探究提升DL-SCA技术效果的研究，并最终应用于一款双界面商用智能卡ECDSA实现的分析场景中，提升侧信道分析在智能卡测评场景中的技术能力。接下来，本节从DL-SCA和信息泄漏预处理方法两个主要方面，阐述与本文主要研究工作直接相关的研究现状与发展趋势。
	\subsection{深度学习侧信道分析}
	
	深度学习（Deep Learning， DL）使用深度神经网络，通过已有的信息或者知识来对未知事物进行预测。随着硬件算力的提升和可用数据的增加，深度学习技术近年来得到了迅速发展。在诸如图像分类\citep{Szegedy17}、目标检测\citep{Girshick15}、语音识别\citep{Hinton12}、自然语言处理\citep{Radford18}等领域，深度学习技术已经取得了远超统计和人工特征提取等传统方法的性能。自2016年以来，深度学习技术已成功应用于侧信道分析领域，展现出了强大的技术效果，并成为了一类重要的研究方向。DL-SCA可以通过网络架构优化和数据增强两种方式提升攻击效果。
	
	在网络架构优化方面，Maghrebi等\citep{Maghrebi16}于2016年使用基于多层感知器（Multi-Layer Perception， MLP）、卷积神经网络（Conventional Neural Network， CNN）、长短时记忆网络（Long Short-Term Memory, LSTM）、循环神经网络（Recurrent Neural Network, RNN）、自动编码机（Auto-Encoder, AE）的模板类侧信道分析，对AES无防护与一阶掩码两种实现进行攻击。在对AES无防护实现攻击方面，这些深度神经网络的结果略优于传统模板攻击；在对AES一阶掩码实现攻击方面，传统模板攻击无法恢复密钥而MLP、CNN、AE成功恢复密钥。这些结果初步说明了DL-SCA技术的可行性以及巨大潜力。在这之后，有许多工作研究如何寻找、调整和优化深度学习模型，提升侧信道分析的效率。Zaid等\citep{Zaid20}为了了解能观测网络的内部运作，发掘深度神经网络的潜力，在特征选择阶段使用一些特定的可视化技术（包括权重可视化、梯度可视化和热图）来清楚地解释每个超参数的作用。Wouters等\citep{Wouters20}研究了如何设计 CNN 网络，以对嵌入式设备的 AES 的多种实现进行侧信道分析，并针对Zaid 等人提出的模型架构的不同要素，纠正了多个误解，证明了卷积滤波器的大小与轨迹中的错位量并无严格关系，增加滤波器的大小和卷积次数实际上会提高网络的性能。Won等\citep{Won21}提出了允许将多种用户定义的预处理技术无缝集成到神经网络架构中的通用框架，以更好地泛化模型。Perin等\citep{Perin22}研究了三种不同特征点选择方案对于深度神经网络的影响，以AES-128一阶掩码软件实现为分析目标，结果发现不同的特征选择方案并不会对深度神经网络效果产生显著影响，均可成功地恢复密钥。Wu等\citep{Wu22}使用深度学习中的相似性学习技术，只进行一轮训练即可找到输入数据中嵌入的敏感信息，实现高效的攻击。
	
	在数据增强方面，Cagli等\citep{Cagli17}将机器学习中的位移变形和添加删除变形两种数据增强方法引入到侧信道分析领域，在Atmega328P微控制器上的AES软件实现数据集上提高了基于CNN的模板类攻击的性能。这表明DL-SCA在处理时序失调以及随机延迟防护对策方面具有技术优势，可以在不做对齐预处理的情况下成功恢复AES单字节密钥。Pu等\citep{Pu17}的工作表明，在预处理步骤之前采用循环位移变形的数据增强方法，可以成功攻击随机延迟采样点个数更多的AES算法实现。在带有随机延迟AES硬件、软件实现两种场景中，为了保证成功，未采用数据增强的侧信道分析只能攻击随机延迟的点数与采样点个数比值分别为5\%、10\%的能量迹；采用数据增强的侧信道分析可以成功对随机延迟的点数与采样点个数比值分别为20\%、20\%的能量迹完成攻击。Kim等\citep{Kim19}改进了神经网络模型，并在此基础上，通过添加噪声的数据增强方法提升DL-SCA效果。针对RD网络，添加噪声的数据增强方法可以提升在DPA v4、AES\_RD数据集上的攻击效果；针对池化模板攻击，添加噪声的数据增强方法可以提升在AES\_HD和ASCADf（N=0）场景上的攻击效果。Picek等\citep{Picek19}和Won等\citep{Won20}通过引入过采样技术和SMOTE，增加少数类的样本数量，解决了使用敏感中间值的汉明重量作为训练标签时侧信道数据中训练样本不均衡问题。Won等\citep{Won20}尝试了SMOTE及其多种变体，共85种数据增强方法\citep{Kovcs19}。从结果来看，85种数据增强方法中，CURE\_SMOTE在AES\_RD数据集上取得的效果最好，但恢复密钥所需能量迹条数依然多于未采用数据增强时DL-SCA恢复密钥所需能量迹条数。ASMOBD、MDO、DEAGO、MSMOTE和SMOTE\_Cosine在ASCADf（N=100）数据集上取得的效果最好，完成攻击所需能量迹条数少于未采用数据增强时的DL-SCA\chenggongtiaoshu 。Luo等\citep{Luo21}首次提出在DL-SCA中利用混淆（Mixup）技术实现数据增强，以扩大训练集，提高攻击成功率。该方法的核心思想是每次随机选取两条迹，并以一定的比例插值生成新的迹。与此同时，训练标签也需要重新生成，新的训练标签应当是迹所对应标签的one-hot编码进行同样比例插值的结果。结果显示在使用混淆技术情况下，使用敏感中间值的最低位作为数据标签的相比于直接使用敏感中间值或敏感中间值的汉明重量可以取得更好的效果，在使用相同数量的能量迹进行攻击的情况下，猜测熵最多减少74\%。Mukhtar等\citep{Mukhtar22}使用条件生成对抗网络和连体网络增广新的样本以提升攻击效果，这种方法可以增广对称密码算法、非对称密码算法实现的训练样本，这些样本可以达到与从现实密码硬件单元运行过程中采集的能量迹类似的效果，从而有效减少现实场景进行侧信道分析时的采集能量迹、电磁迹的时间。
	
	网络架构优化、数据增强都在以AES为代表的分组密码的某一种或少数几种特定实现的DL-SCA中取得了优异的效果。但是这些优化技术能否直接用于对以ECDSA为代表的公钥密码实现的DL-SCA、如何调整数据增强方法和深度学习模型使得侧信道分析结果最有助于恢复公钥密码实现的密钥（最有助于减小恢复密钥的时间）尚缺乏深入研究。因此，设计出一个适用于多种算法实现的通用数据增强方法，提高深度学习模型对于敏感信息泄漏特征刻画的效率，是提升DL-SCA技术效果的关键。因此，亟待开展面向基于深度学习侧信道分析的通用数据增强方法研究。
	
	\subsection{信息泄漏预处理方法}
	%将对齐和提取POI、降噪，算作ECDSA芯片卡预处理的背景、现状。
	%\subsection{信息泄漏分析方法}
	%TA、DL-SCA和DA。算AES和ECDSA攻击的背景、现状。
	预处理通过两种途径提升侧信道分析技术效果，一种是以降低采样点个数为主，另一种以降低噪声为主。
	
	降低采样点个数的预处理方法，本质上是在尽可能不损信息泄漏的情况下降低信息泄漏的维度。在降低能量迹、电磁迹的采样点个数之后分析人员就可以使用准确但（关于信息泄漏维度的）时间复杂度高的工具（例如深度学习模型）完成敏感信息泄漏的恢复，攻击所需的能量迹、电磁迹条数也会相应降低。Bruneau等\citep{bruneau:hal-01218072}提出使用主成分分析（Principal Component Analysis， PCA）的预处理方法，通过将能量迹上的信息泄漏集中到少数几个维度来提高信噪比。实验结果表明，当PCA输出的维度设置恰当的条件下，应用PCA可以大幅减少能量迹采样点个数（减少比例可达99\%），提升相关能量攻击的技术效果。Pozo等\citep{Pozo15}提出奇异谱分析的预处理方法，它可以使得预处理后的能量迹信噪比提升为原来的2.5倍。这些方法只适用于本身已经对齐的能量迹，而不适合对使用了随机延迟防护措施的密码实现能量迹进行降维。为了分析使用了随机延迟防护措施的密码实现，除了使用上述降维技术，还需要先使用静态对齐\citep{Homma08}、动态对齐\citep{Woudenberg11}等方法对能量迹做对齐预处理。但是，即使结合了现有对齐和降维技术，对于作为分析目标的双界面商用智能卡来说，预处理的时间复杂度过高，预处理计算量还是太大，以现有算力难以在可接受的时间范围内完成预处理。
	
	降低噪声的预处理方法可以在不对齐的情况下降低能量迹、电磁迹的噪声。这样一来，敏感信息泄漏特征变得更加明显，模型对敏感信息泄漏特征刻画变得更为准确，攻击所需的能量迹、电磁迹条数也会相应降低。Yang等\citep{Yang19}应用基于AE的降噪预处理方法提升DL-SCA在分析高噪声AES密码实现的技术效果，攻击所需的电磁迹条数可以减少50\%。频域预处理方法也能达到类似于降低噪声的效果，Belgarric等\citep{Belgarric16}提出了一种基于短时傅里叶变换的侧信道分析方法，在分析一阶掩码防护型软件实现的场景中，攻击成功所需要的能量迹条数相比于二阶相关系数攻击可以减少30\%。Debande等\citep{Debande12}提出一种基于小波变换的侧信道分析方法，在分析无防护DES软件实现的场景中，攻击成功所需要的能量迹条数相比于相关系数攻击可以减少50\%。总的来说，降低噪声或频域变换的预处理方法可以有效提升对分组密码的侧信道分析结束效果。但是对于作为研究目标的双界面商用智能卡来说，电磁迹的采样点个数极大（达到50000000），降低噪声或进行频域变换的计算量和时间开销巨大；电磁迹敏感信息泄漏特征不明显，预处理之后很可能会漏掉大量特征点或将噪声点误判为特征点，进而影响电磁迹本身的正确性；即使完成了降噪预处理，采样点个数也不会减少，难以使用现有工具（如DL-SCA、传统模板攻击、相关能量分析）进行侧信道分析。
	
	信息泄漏预处理方法对于实施现实场景的侧信道分析具有重要意义，现实场景因为密码算法、防护措施、实现平台、信息泄漏采集环境等多种因素具有多样性，其对应的信息泄漏预处理方法各异。这些信息泄漏预处理方法不具有通用性，不适合对本研究的分析目标双界面商用智能卡ECDSA实现的电磁迹进行预处理。在这种条件下，如何设计适用于目标双界面智能卡ECDSA实现信息泄漏预处理方法，使得预处理之后有可能在可接受的攻击时间内完成侧信道分析成为了智能卡测评中所面临的关键问题。因此亟待开展信息泄漏预处理方法研究。
	\section{本文研究内容}
	本文以提升对一类双界面商用智能卡的侧信道分析方法的技术效果为最终目标，从\jiaodu 出发，开展两个阶段的侧信道分析研究：以多种AES算法实现为研究目标的通用数据增强方法效果量化研究、以一类双界面商用智能卡上ECDSA实现为研究目标的侧信道分析实证研究。\ifshowcontent 相关研究工作“面向基于深度学习侧信道分析的通用数据增强方法”已被《信息安全学报》录用。\fi
	\subsection{面向基于深度学习侧信道分析的通用数据增强方法}
	在深度学习的训练阶段对训练数据集进行数据增强可以使训练出的模型更准确，进而降低成功实施DL-SCA时的能量迹条数。然而，当前已有数据增强方法的参数选取通常高度依赖专家知识，且只适合对特定算法实现数据集进行数据增强。因此，构造一个适用于多种算法实现数据集的通用数据增强方法、自适应地选取数据增强参数，具有重要现实意义。本文提出了面向深度学习侧信道攻击的通用数据增强方法，其核心思想是采用模拟退火机制依据反馈信号自适应地调整数据增强策略参数，以适应不同算法实现数据集的数据增强，有效解决了数据增强策略参数选择难的技术问题。与未采用数据增强方法的DL-SCA效果相比，在AES\_RD、AES\_HD、DPA v4、ASCADf（N=0/N=50/N=100）四种数据集六个场景下，\chenggongtiaoshu 分别降低0、21\%、25\%、24\%、48\%以及5\%。
	\subsection{针对双界面商用智能卡ECDSA实现的电磁分析方法}
	%\tableref{tab:problemset}汇总了攻击双界面商用智能卡ECDSA私钥时，本研究需要解决的问题以及相应的解决方案。
	
	%在攻击目标双界面商用智能卡ECDSA实现时，存在电磁迹采集条件受限、DL-SCA所常用的评估指标不适合本研究的问题，同时因为计算资源、存储空间、可接受的攻击时间等限制，现有技术难以实施侧信道分析。在这样的场景下，本研究提出使用敏感信息泄漏估计真阳性率作为深度学习量化指标、通过提取特征点减少深度学习模型对计算资源和存储空间的需求、使用数据增强方法减小采集电磁迹的时间开销、提出基于假设检验的敏感信息泄漏估计方案减少运用格方法恢复私钥的时间。采用本研究针对双界面商用智能卡ECDSA实现的电磁分析方法，可以将DL-SCA的训练阶段计算量减小到$1.727\cdot10^{11}$浮点运算次数，为原来的0.16\%，DL-SCA变得可行。还可以将运用格方法恢复目标双界面商用智能卡ECDSA私钥的时间从理论上超过七百万年减少到400秒。实际攻击表明，即使将采集电磁迹的时间计入攻击时间，只用4天就能完成攻击，仍然比理论值大约快了$2^{29}$倍。
	{\color{\xchange}
	
	在分析一款双界面商用智能卡的ECDSA实现时，需要将侧信道分析与格方法结合才可能利用当前实验环境在可接受的时间范围内恢复私钥。在实际分析时，电磁迹条数少、采样点多、特征点不明显等多种原因导致实施DL-SCA时间长、运用格方法的时间长的问题。本研究应用提出的面向基于深度学习侧信道分析的通用数据增强方法，针对电磁迹的特点设计了\yuchuli 预处理技术，将DL-SCA攻击阶段对敏感信息泄漏的估计方法由极大似然估计替换为\jiashejianyanguji，将执行DL-SCA的时间由315天减小到1小时、运用格方法的时间由$2\times10^{85}$减小到400秒，在成功恢复ECDSA私钥的前提下显著减少了所需要的时间。实际攻击中本研究仅用4天就恢复了ECDSA私钥，其分析思路和技术方法可以应用于其他类型的双界面商用智能卡分析场景中，为开展其他类似密码硬件单元的分析与破解提供可行的思路和真实的案例。
	}
	%问题困难性所在。解决问题的效果。
	\section{本文组织结构}
	本文总共分为五个章节，\chapref{chap:introduction}为引言，主要阐述DL-SCA是一个重点研究领域，其中，特别指出以一类双界面商用智能卡上ECDSA实现为例进行侧信道分析，对于提升智能卡测评技术具有重要意义；\chapref{chap:preliminary}为预备知识，主要介绍侧信道分析相关的基础知识，以及研究中使用的数据增强、模拟退火等技术，还有ECDSA的基本原理；\chapref{chap:search1}研究了对数据增强方法进行研究，提出了面向基于深度学习侧信道分析的通用数据增强方法，选取了不同的AES实现作为分析目标，验证并分析了通用数据增强方法的技术效果；\chapref{chap:search2}对一款双界面商用智能卡ECDSA实现进行实际攻击，在可接受的攻击时间内完成侧信道分析，恢复了ECDSA的私钥；\chapref{chap:conclusion}对本文研究进行总结，对未来研究方向的做出自己的预测和估计。
}
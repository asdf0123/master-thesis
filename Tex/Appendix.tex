\thispagestyle{appendixheader}
\stepcounter{app}
\setcounter{app_fig}{1}
\setcounter{app_tab}{1}
\setcounter{equation}{0}
\renewcommand\theequation{附\arabic{app}-\arabic{equation}}
% \renewcommand\theequation{\Alph{app}.\arabic{equation}}
\renewcommand\chaptername{附录}
\renewcommand\chaptername{Appendix} 
\renewcommand\thechapter{附录\zhnum{app}} 

\setcounter{chapter}{0}
\setcounter{section}{0}
\chapter{附录中的公式}\label{chap:app1}{
	\setcounter{app_fig}{1}
	\begin{proposition}\label{prop:ECDSA-authentication}
		如果$(r,s)$是签名者对消息$m_0$的签名，那么$R.x=r$。 
	\end{proposition}
	\begin{proof}
		\begin{align*}
			R&=u_1\cdot \pk+u_2\cdot G \\
			&= u_1\sk\cdot G+u_2\cdot G \\
			&= s^{-1}r\sk\cdot G+\left(s^{-1}H(m_0)\right)\cdot G \\
			&= \left(s^{-1}r\sk+\left(s^{-1}H(m_0)\right)\right)\cdot G \\
			&= \left(s^{-1}\left(r\sk+H(m_0)\right)\right)\cdot G \\
			&= \left(s^{-1}\left(r\sk+H(m_0)\right)\bmod q\right)\cdot G
		\end{align*}
		因为$$s\equiv \nonce^{-1}(H(m_0)+r\sk) \pmod q$$
		所以\begin{align*}
			R&= \left(\frac{r\sk+H(m_0)}{\nonce^{-1}(H(m_0)+rd)}\bmod q\right)\cdot G \\
			&= \left(\frac{\nonce(H(m_0)+r\sk)}{H(m_0)+r\sk}\bmod q\right)\cdot G \\
			&= \left(\nonce\bmod q\right)\cdot G \\
			&= \nonce\cdot G
		\end{align*}
		因此\begin{align*}
			R.x&=\left(\nonce\cdot G\right).x\\
			&=Q.x\\
			&=r
		\end{align*}
	\end{proof}
		
	\begin{proposition}\label{prop:expotime}
		如果\zyx$p$略小于100\%，运用格方法恢复实际私钥的时间的期望会随着\zyx$p$的下降而乘指数级增长。
	\end{proposition}
	\begin{proof}
		令构造方程所需的可利用的泄漏总量为$s$比特，构造方程的每条签名恢复了连续$r$比特敏感中间值（即可利用的泄漏有$r$比特），运用一次格基规约时间开销为$u$。
		
		（本研究所调用的）格方法只运用nonce数值为0的比特。nonce比特0恢复准确这一事件对于每个样本是互相独立的，因此对于任意一条构造签名的能量迹，所利用的被恢复的比特准确的概率为$p_r=p^r$。
	
		能量迹恢复的泄漏没有错误这一事件对于每条能量迹是互相独立的，因此对于构造签名的所有能量迹，恢复的泄漏都没有错误的概率为\begin{align*}
			p_s&=p_r^{\frac sr}\\
			&=\left(p^r \right) ^{\frac sr}\\
			&=p^s
		\end{align*}
	
		利用签名多次构造方程并运用格方法求解实际私钥是伯努利实验。因此，如果构造方程的所有能量迹恢复的泄漏都没有准确，那么运用格方法一定可以求解出实际私钥。在这种情况下，多次尝试构造方程并运用格方法直至求解出私钥的方法，到恢复实际私钥为止所尝试的次数$\xi$服从参数为$p_s$的几何分布，即$\xi\sim G(p_s)$。
		
		因此，恢复实际私钥的时间是$u\xi$。结合$\xi\sim G(p_s)$，可以推算\begin{align*}
			E(u\xi)&=uE(\xi)\\
			&=u\frac{1}{p_s}\\
			&=\frac{u}{p^s}\\
		\end{align*}
	
		注意到自变量$p$是底数，我们对公式在$p=1$处进行泰勒展开\begin{align*}
			E(u\xi)&=\frac{u}{p^s}\\
			&=u\left( \frac1p\right) ^s\\
			&=u\left( \sum\limits_{i=0}^{\infty}\left( 1-p\right) ^i-1\right) ^s\\
			&>u\left( \sum\limits_{i=0}^{1}\left( 1-p\right) ^i-1\right) ^s\\
			&=u\left( 1-p\right) ^s
		\end{align*}

	\end{proof}
	当构造的方程维度和格方法确定后，运用一次格方法的时间开销$u$以及构造方程所需的可利用的泄漏总量$s$保持不变。对于本文使用的格方法，$r=4,s=4\times75=300,u=400$秒。%构造方程所需的可利用的泄漏总量会因为ECDSA的位数而有所不同。对于256位ECDSA，$s$理论上的下界是256，实际攻击中，在$r=4$的情况下。
	
	又由于推导过程中假设了“构造方程的所有能量迹恢复的泄漏没有错误时格方法一定可以求解出实际私钥”，在实际攻击中，恢复实际私钥的时间的期望会比理论值更大。
	
	\begin{proposition}\label{prop:highalpha}
		对于$T_a$条电磁迹，每条电磁迹中包含$n_s$次迭代的情况，总共有$T_an_s$条电磁子迹，它们会包含总共$T_an_s$比特的一次性随机数$\nonce$的高比特泄漏的值，即$\nonce^{(i)}_j,i=0,1,\dots,T_a-1,j=0,1,\dots,n_s-1$。根据ECDSA实现可以推算有比例约为$\frac38$的样本是原本就对应nonce的比特0。不妨假设每个样本以$p_{pred0}$的概率被估计为0，且不同样本的估计结果互相独立。
		如果\zyx 为100\%，
		%如果被预测为对应的中间值$\leakedmultiplier_i=1$的电磁子迹数与所有电磁子迹数比值为$p_{pred1}$，对于被预测为对应的中间值$\leakedmultiplier_i=1$的电磁子迹敏感中间值$\tilde \nonce_j$恢复准确率都为100\%，构造方程所有敏感中间值没有错误时求解算法$S$一定
		运用格方法可以求解出实际私钥。此时能否恢复私钥取决于能否筛选出含有足够多（75条）可利用（连续4比特估计为0的敏感中间值）的签名构造方程。那么只要$\epsilon=T_a\pi_{n_s}(4)-75\ge0$，就有超过$1-\frac{\epsilon+75}{\epsilon^2}$的概率\footnote{实际上二项分布的累积分布函数可以用正则化不完全$Beta$函数表示，这个概率更精确的近似结果为$I_{\pi_{n_s}(4)}(75+1,T_a-75)=(75+1)\begin{pmatrix}T_a\\75\end{pmatrix}\int_0^{\pi_{n_s}(4)}t^{75}(1-t)^{T_a-75-1}\mathrm dt$。}可以构造方程，进而恢复私钥。其中，$\pi_{j}(k)$满足\equationref{eq:recursion}描述的递推关系。
		\begin{equation}\label{eq:recursion}
			\pi_{j}(k)=\begin{cases}
				1,j=0,k=0\\
				0,j=0,k>0\\
				(1-p_{pred0})\sum\limits_{t=0}^{3}\pi_{j-1}(t),j>0,k=0\\
				p_{pred0}\pi_{j-1}(k-1),j>0,0<k<4\\
				\pi_{j-1}(k)+p_{pred0}\pi_{j-1}(k-1),j>0,k=4
			\end{cases}\\
		\end{equation}
	\end{proposition}
	\begin{proof}
	实际上$\Vector{\pi_j}$的物理含义是概率分布，$\pi_j(k)$表示服从概率分布$\Vector\pi_j$的随机变量$X_j$取值为$k$的概率。假设$\Vector X=(X_n,n\ge0)$是马尔科夫链，状态空间为$\mathcal E=\left\lbrace 0,1,2,3,4\right\rbrace $，转移概率矩阵为$$P=\begin{bmatrix}
	1-p_{pred0}&p_{pred0}&0&0&0\\
	1-p_{pred0}&0&p_{pred0}&0&0\\
	1-p_{pred0}&0&0&p_{pred0}&0\\
	1-p_{pred0}&0&0&0&p_{pred0}\\
	0&0&0&0&1
	\end{bmatrix},$$初始分布为$\Vector\pi_0=\begin{bmatrix}
	1&0&0&0&0
	\end{bmatrix}$。转移概率矩阵$P$所对应的有向图为\appfigureref{appfig:pdag}。
	
	\begin{appfig}[!h]
		\centering
		\begin{tikzpicture}[scale=0.2]
			\tikzstyle{every node}+=[inner sep=0pt]
			\draw [black] (25,-25) circle (3);
			\draw (25,-25) node {$0$};
			\draw [black] (5,-5) circle (3);
			\draw (5,-5) node {$1$};
			\draw [black] (25,-5) circle (3);
			\draw (25,-5) node {$2$};
			\draw [black] (45,-5) circle (3);
			\draw (45,-5) node {$3$};
			\draw [black] (45,-25) circle (3);
			\draw (45,-25) node {$4$};
			\draw [black] (26.323,-27.68) arc (54:-234:2.25);
			\draw (25,-32.25) node [below] {$1-p_{pred0}$};
			\fill [black] (23.68,-27.68) -- (22.8,-28.03) -- (23.61,-28.62);
			\draw [black] (8,-5) -- (22,-5);
			\fill [black] (22,-5) -- (21.2,-4.5) -- (21.2,-5.5);
			\draw (15,-4.5) node [above] {$p_{pred0}$};
			\draw [black] (28,-5) -- (42,-5);
			\fill [black] (42,-5) -- (41.2,-4.5) -- (41.2,-5.5);
			\draw (35,-4.5) node [above] {$p_{pred0}$};
			\draw [black] (45,-8) -- (45,-22);
			\fill [black] (45,-22) -- (45.5,-21.2) -- (44.5,-21.2);
			\draw (45.5,-15) node [right] {$p_{pred0}$};
			\draw [black] (22.013,-25.237) arc (-90.41225:-179.58775:17.375);
			\fill [black] (4.76,-7.99) -- (4.27,-8.79) -- (5.27,-8.78);
			\draw (8.83,-20.62) node [below] {$p_{pred0}$};
			\draw [black] (7.12,-7.12) -- (22.88,-22.88);
			\fill [black] (22.88,-22.88) -- (22.67,-21.96) -- (21.96,-22.67);
			\draw (17.02,-13.00) node [above] {$1-p_{pred0}$};
			\draw [black] (25,-8) -- (25,-22);
			\fill [black] (25,-22) -- (25.5,-21.2) -- (24.5,-21.2);
			\draw (25.5,-13) node [right] {$1-p_{pred0}$};
			\draw [black] (42.88,-7.12) -- (27.12,-22.88);
			\fill [black] (27.12,-22.88) -- (28.04,-22.67) -- (27.33,-21.96);
			\draw (32,-20) node [right] {$1-p_{pred0}$};
			\draw [black] (46.323,-27.68) arc (54:-234:2.25);
			\draw (45,-32.25) node [below] {$1$};
			\fill [black] (43.68,-27.68) -- (42.8,-28.03) -- (43.61,-28.62);
		\end{tikzpicture}
		\bicaption{\enspace 矩阵$P$所对应的有向图}{\enspace Corresponding directed acyclic graph of matrix $P$}
		
		\label{appfig:pdag}
		\stepcounter{app_fig}
	\end{appfig}
	
	状态空间$\mathcal E$的每个状态有如下定义：
	
	\begin{enumerate}
		\item [0] 没有足够的把握认为当前敏感中间值估计值$\hat\nonce_j=0$；
		\item [1] 有足够的把握认为当前敏感中间值估计值$\hat\nonce_j=0$，但没有足够的把握认为上一次敏感中间值估计值$\hat\nonce_{j-1}=0$；
		\item [2] 有足够的把握认为上一次和当前敏感中间值估计值$\hat\nonce_{j-1}=\hat\nonce_j=0$，但没有足够的把握认为上上一次敏感中间值估计值$\hat\nonce_{j-2}=0$；
		\item [3] 有足够的把握认为上上一次、上一次和当前敏感中间值估计值$\hat\nonce_{j-2}=\hat\nonce_{j-1}=\hat\nonce_j=0$，但没有足够的把握认为上上上一次敏感中间值估计值$\hat\nonce_{j-3}=0$；
		\item [4] $\exists 3\le t\le j$，有足够的把握认为到$t$为止的连续4比特敏感中间值估计值估计都为0，即$\hat\nonce_{t-3}=\hat\nonce_{t-2}=\hat\nonce_{t-1}=\hat\nonce_{t-0}=0$。
	\end{enumerate}

	容易验证，从采集的（含有一次性随机数$\nonce$共$n_s$个高比特泄漏的）一条电磁迹中恢复出可利用（连续4比特估计值为0的敏感中间值）比特泄漏的概率就是$\pi_{n_s}(4)$。$\Vector \pi_{n_s}$可以通过时间复杂度$\Theta(n_s)$的递推公式直接计算，也可以利用$\Vector \pi_{n_s}=\Vector \pi_0 P^{n_s}$并结合矩阵快速幂以$\Theta(\log n_s)$的复杂度进行计算。
		
	%实际上$\pi_{i}(j)$的物理含义某种概率，在$j<4$时它表示对于随机的一条迹，预测$\nonce_{i-j+1},\nonce_{i-j+2},\dots,\nonce_{i}$同时为0的概率，在$j=4$时它表示根据预测结果$\nonce_0,\nonce_1,\dots,\nonce_i$中存在至少连续4比特都被预测为0的概率。
	
	%因此，$\pi_{n_s}(4)$可以描述从采集的一条迹中恢复出（对于本研究使用的求解算法$S$）可利用的敏感中间值的概率。
	显然$T_a$条电磁迹中可以恢复出可利用的比特泄漏的电磁迹的数量$\xi$服从参数为$n=T_a,p=\pi_{n_s}(4)$的二项分布，即$\xi\sim B(T_a,\pi_{n_s}(4))$。能成功构造方程并求解出实际私钥\footnote{如果$\xi<75$，那么无法过滤出足够多的含有可利用泄漏的签名，无法构造方程，因此无法求解出实际私钥。}当且仅当$75\le\xi$。
	
	容易知道该二项分布的均值的方差$\mathbb E\xi=T_a\pi_{n_s}(4)=\epsilon+75,\mathbb D\xi=T_a\pi_{n_s}(4)(1-\pi_{n_s}(4))\le T_a\pi_{n_s}(4)=\epsilon+75$。
	
	通过放缩可以知道\begin{align*}
		\Pr\left[75\le\xi\right]&\ge\Pr\left[75<\xi\right]\\
		&\ge\Pr\left[75<\xi<75+2\epsilon\right]\\
		&=\Pr\left[\vert \xi-(75+\epsilon)\vert<\epsilon\right]\\
		&=\Pr\left[\vert \xi-\mathbb E\xi\vert<\epsilon\right]\\
		&=1-\Pr\left[\vert \xi-\mathbb E\xi\vert\ge\epsilon\right]
	\end{align*}
	
	结合切比雪夫不等式$\Pr\left[\vert \xi-\mathbb E\xi\vert\ge\epsilon\right]\le \frac{\mathbb D\xi}{\epsilon^2}$可以知道
	
	\begin{align*}
		\Pr\left[75\le\xi\right]&\ge1-\Pr\left[\vert \xi-\mathbb E\xi\vert\ge\epsilon\right]\\
		&\ge 1-\frac{\mathbb D\xi}{\epsilon^2}\\
		%&=1-\frac{T_ag_{n_s,4}(1-\pi_{n_s}(4))}{\epsilon^2}\\
		&\ge1-\frac{\epsilon+75}{\epsilon^2}
	\end{align*}

	\end{proof}
	对于本研究，$T_a=5000,n_s=30$，不妨令$\epsilon=50$，据此可以计算$\pi_{30}(4)=0.025,p_{pred0}\approx0.18354$，从而显著性水平$\alpha=\frac{\frac38-p_{pred0}}{\frac38}\approx0.51056$。这就是说，在前提假设都成立的情况下，对于本研究采集的5000条电磁迹，虽然它理论上含有约150000比特泄漏（实际含有133493比特泄漏），但只要我们可以指出其中27531比特对应的敏感中间值$\hat\nonce^{(i)}_j=0,i=0,1,\dots,4999,j=0,1,\dots,29$，那么一定有超过95\%的概率\footnote{实际上概率的精确值保留16位小数的结果为0.9999992772226471}恢复私钥。
		

%对公式的引用如，公式\eqref{eq:appedns}
%\begin{equation} \label{eq:appedns}
%    % \adddotsbeforeeqnnum%
%    \begin{cases}
%        \frac{\partial \rho}{\partial t} + \nabla\cdot(\rho\Vector{V}) = 0\\
%        \frac{\partial (\rho\Vector{V})}{\partial t} + \nabla\cdot(\rho\Vector{V}\Vector{V}) = \nabla\cdot\Tensor{\sigma}\\
%        \frac{\partial (\rho E)}{\partial t} + \nabla\cdot(\rho E\Vector{V}) = \nabla\cdot(k\nabla T) + \nabla\cdot(\Tensor{\sigma}\cdot\Vector{V})
%    \end{cases}
%\end{equation}
%
%\begin{equation} \label{eq:appedns2}
%    % \adddotsbeforeeqnnum%
%    \begin{cases}
%        \frac{\partial \rho}{\partial t} + \nabla\cdot(\rho\Vector{V}) = 0\\
%        \frac{\partial (\rho\Vector{V})}{\partial t} + \nabla\cdot(\rho\Vector{V}\Vector{V}) = \nabla\cdot\Tensor{\sigma}\\
%        \frac{\partial (\rho E)}{\partial t} + \nabla\cdot(\rho E\Vector{V}) = \nabla\cdot(k\nabla T) + \nabla\cdot(\Tensor{\sigma}\cdot\Vector{V})
%    \end{cases}
%\end{equation}


%mathtext: $A,F,L,2,3,5,\sigma$, mathnormal: $A,F,L,2,3,5,\sigma$, mathrm: $\mathrm{A,F,L,2,3,5,\sigma}$.
%
%mathbf: $\mathbf{A,F,L,2,3,5,\sigma}$, mathit: $\mathit{A,F,L,2,3,5,\sigma}$, mathsf: $\mathsf{A,F,L,2,3,5,\sigma}$.
%
%mathtt: $\mathtt{A,F,L,2,3,5,\sigma}$, mathfrak: $\mathfrak{A,F,L,2,3,5,\sigma}$, mathbb: $\mathbb{A,F,L,2,3,5,\sigma}$.
%
%mathcal: $\mathcal{A,F,L,2,3,5,\sigma}$, mathscr: $\mathscr{A,F,L,2,3,5,\sigma}$, boldsymbol: $\boldsymbol{A,F,L,2,3,5,\sigma}$.
%
%vector: $\Vector{\sigma, T, a, F, n}$, unitvector: $\unitVector{\sigma, T, a, F, n}$
%
%matrix: $\Matrix{\sigma, T, a, F, n}$, unitmatrix: $\unitMatrix{\sigma, T, a, F, n}$
%
%tensor: $\Tensor{\sigma, T, a, F, n}$, unittensor: $\unitTensor{\sigma, T, a, F, n}$ 
%

\thispagestyle{appendixheader}
}

\chapter{附录中的图表}{
	\stepcounter{app}
	\setcounter{app_fig}{1}
	\setcounter{app_tab}{1}
	
	
	\begin{apptab}[!htb]
		\bicaption{\enspace 无噪声$\leakedmultiplier_j$泄漏场景下可推断的敏感中间值$\tilde \nonce_j$和$\nonce_j$的信息}{\enspace Deduced information of $\tilde \nonce_j$ and $\nonce_j$ from Noise Free $\leakedmultiplier_j$}
		\stepcounter{app_tab}
		\label{apptab:infoonsymbol}
		\centering
		\footnotesize% fontsize
		\begin{tabular}{cc|ccc|c}
			\hline
			$\leakedmultiplier_j$可能的取值$u$&$\Pr[\leakedmultiplier_j=u]$&${\tilde \nonce}_j$可能的取值$v$&$v$的二进制形式&$\Pr[{\tilde \nonce}_j=v|\leakedmultiplier_j=u]$&能完全确定的敏感信息$\nonce_j$估计值\\
			\hline
			\multirow{4}*{1}&\multirow{4}*{3/8}&0&00&1/3&\multirow{4}*{$\nonce_j=0$}\\
			\cdashline{3-5} &&1&01&2/3&\\
			\cdashline{3-5} &&2&10&0&\\
			\cdashline{3-5} &&3&11&0&\\
			\hline
			\multirow{4}*{2}&\multirow{4}*{5/16}&0&00&1/5&\multirow{4}*{$\nonce_{j+129}=0$}\\
			\cdashline{3-5} &&1&01&0&\\
			\cdashline{3-5} &&2&10&4/5&\\
			\cdashline{3-5} &&3&11&0&\\
			\hline
			\multirow{4}*{3}&\multirow{4}*{5/16}&0&00&1/5&\multirow{4}*{/}\\
			\cdashline{3-5} &&1&01&0&\\
			\cdashline{3-5} &&2&10&0&\\
			\cdashline{3-5} &&3&11&4/5&\\
			\hline
		\end{tabular}
	\end{apptab}
	
	
	\begin{appfig}[!htb]
		\centering
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/ge3ddpav4}
			\caption{DPA v4}
			\label{fig:ge3ddpav4}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/ge3daeshd}
			\caption{AES\_HD}
			\label{fig:ge3daeshd}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/ge3daesrd}
			\caption{AES\_RD}
			\label{fig:ge3daesrd}
		\end{subfigure}
		\\% line break
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/ge3dascad0}
			\caption{ASCADf（N=0）}
			\label{fig:ge3dascad0}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/ge3dascad50}
			\caption{ASCADf（N=50）}
			\label{fig:ge3dascad50}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/ge3dascad100}
			\caption{ASCADf（N=100）}
			\label{fig:ge3dascad100}
		\end{subfigure}
		\\% line break
		\bicaption{\enspace 所有迭代过程正确密钥猜测熵曲线}{\enspace GE curves of correct key for all iterations}
		\label{appfig:ge3d}
		\stepcounter{app_fig}
	\end{appfig}
	
	\begin{appfig}[!htb]
		\centering
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/adadpav4}
			\caption{DPA v4}
			\label{fig:adadpav4}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/adaaeshd}
			\caption{AES\_HD}
			\label{fig:adaaeshd}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/adaaesrd}
			\caption{AES\_RD}
			\label{fig:adaaesrd}
		\end{subfigure}
		\\% line break
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/adaascad0}
			\caption{ASCADf（N=0）}
			\label{fig:adaascad0}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/adaascad50}
			\caption{ASCADf（N=50）}
			\label{fig:adaascad50}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/adaascad100}
			\caption{ASCADf（N=100）}
			\label{fig:adaascad100}
		\end{subfigure}
		\\% line break
		\bicaption{\enspace 采用通用数据增强方法时DL-SCA正确密钥猜测熵}{\enspace GE of DL-SCA with adaptive DA method}
		\label{appfig:adadlsca}
		\stepcounter{app_fig}
	\end{appfig}
	
	\begin{appfig}[!htb]
		\centering
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/origindpav4}
			\caption{DPA v4}
			\label{fig:origindpav4}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/originaeshd}
			\caption{AES\_HD}
			\label{fig:originaeshd}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/originaesrd}
			\caption{AES\_RD}
			\label{fig:originaesrd}
		\end{subfigure}
		\\% line break
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/originascad0}
			\caption{ASCADf（N=0）}
			\label{fig:originascad0}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/originascad50}
			\caption{ASCADf（N=50）}
			\label{fig:originascad50}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/originascad100}
			\caption{ASCADf（N=100）}
			\label{fig:originascad100}
		\end{subfigure}
		\\% line break
		\bicaption{\enspace 无数据增强时DL-SCA正确密钥猜测熵}{\enspace GE of DL-SCA without DA}
		\label{appfig:origindlsca}
		\stepcounter{app_fig}
	\end{appfig}
	
	\begin{appfig}[!htb]
		\centering
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i0-j1-k2}
			\caption{第一处POIs,$\tilde\nonce_j=1$ vs $\tilde\nonce_j=2$}
			\label{fig:aligndemo012}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i0-j1-k3}
			\caption{第一处POIs,$\tilde\nonce_j=1$ vs $\tilde\nonce_j=3$}
			\label{fig:aligndemo013}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i0-j2-k3}
			\caption{第一处POIs,$\tilde\nonce_j=2$ vs $\tilde\nonce_j=3$}
			\label{fig:aligndemo023}
		\end{subfigure}
		\\% line break
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i1-j1-k2}
			\caption{第二处POIs,$\tilde\nonce_j=1$ vs $\tilde\nonce_j=2$}
			\label{fig:aligndemo112}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i1-j1-k3}
			\caption{第二处POIs,$\tilde\nonce_j=1$ vs $\tilde\nonce_j=3$}
			\label{fig:aligndemo113}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i1-j2-k3}
			\caption{第二处POIs,$\tilde\nonce_j=2$ vs $\tilde\nonce_j=3$}
			\label{fig:aligndemo123}
		\end{subfigure}
		\\% line break
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i2-j1-k2}
			\caption{第三处POIs,$\tilde\nonce_j=1$ vs $\tilde\nonce_j=2$}
			\label{fig:aligndemo212}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i2-j1-k3}
			\caption{第三处POIs,$\tilde\nonce_j=1$ vs $\tilde\nonce_j=3$}
			\label{fig:aligndemo213}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i2-j2-k3}
			\caption{第三处POIs,$\tilde\nonce_j=2$ vs $\tilde\nonce_j=3$}
			\label{fig:aligndemo223}
		\end{subfigure}
		\\% line break
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i3-j1-k2}
			\caption{第四处POIs,$\tilde\nonce_j=1$ vs $\tilde\nonce_j=2$}
			\label{fig:aligndemo312}
		\end{subfigure}%
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i3-j1-k3}
			\caption{第四处POIs,$\tilde\nonce_j=1$ vs $\tilde\nonce_j=3$}
			\label{fig:aligndemo313}
		\end{subfigure}
		~% add desired spacing
		\begin{subfigure}[b]{\trif\textwidth}
			\includegraphics[width=\textwidth]{appfig/aligndemo-i3-j2-k3}
			\caption{第四处POIs,$\tilde\nonce_j=2$ vs $\tilde\nonce_j=3$}
			\label{fig:aligndemo323}
		\end{subfigure}
		\\% line break
		\bicaption{\enspace 合计1000次迭代所对应的电磁迹TVLA结果}{\enspace TLVA Results of 1000 Subtraces}
		\label{appfig:aligndemoall}
		\stepcounter{app_fig}
	\end{appfig}
	
%	\begin{appfig}[!htb]
%		\centering
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l0-r1}
%			\caption{$\delta_0$样本}
%			\label{fig:delta01}
%		\end{subfigure}%
%		~% add desired spacing
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l1-r2}
%			\caption{$\delta_1$样本}
%			\label{fig:delta12}
%		\end{subfigure}
%		\\% line break
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l2-r3}
%			\caption{$\delta_2$样本}
%			\label{fig:delta23}
%		\end{subfigure}%
%		~% add desired spacing
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l3-r4}
%			\caption{$\delta_3$样本}
%			\label{fig:delta34}
%		\end{subfigure}
%		\\% line break
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l0-r2}
%			\caption{$\delta_4$样本}
%			\label{fig:delta02}
%		\end{subfigure}%
%		~% add desired spacing
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l1-r3}
%			\caption{$\delta_5$样本}
%			\label{fig:delta13}
%		\end{subfigure}
%		\\% line break
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l2-r4}
%			\caption{$\delta_6$样本}
%			\label{fig:delta24}
%		\end{subfigure}%
%		~% add desired spacing
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l0-r3}
%			\caption{$\delta_7$样本}
%			\label{fig:delta03}
%		\end{subfigure}
%		\\% line break
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l1-r4}
%			\caption{$\delta_8$样本}
%			\label{fig:delta14}
%		\end{subfigure}%
%		~% add desired spacing
%		\begin{subfigure}[b]{\twof\textwidth}
%			\includegraphics[width=\textwidth]{appfig/delta-l0-r4}
%			\caption{$\delta_9$样本}
%			\label{fig:delta04}
%		\end{subfigure}
%		\\% line break
%		
%		\bicaption{\enspace 合计1000次迭代所对应的信息泄漏位置之差频数直方图}{\enspace Frequency Histogram of Leak Position Differences of 1000 Subtraces}
%		\label{appfig:deltaall}
%		\stepcounter{app_fig}
%	\end{appfig}
	
%
%附表测试
%
%\begin{apptab}[!htbp]
%    \bicaption{\enspace 这是一个样表}{\enspace This is a sample table}
%    \stepcounter{app_tab}
%    \label{apptab:1}
%    \centering
%    \footnotesize% fontsize
%    \setlength{\tabcolsep}{4pt}% column separation
%    \renewcommand{\arraystretch}{1.2}%row space 
%    \begin{tabular}{lcccccccc}
%        \hline
%        行号 & \multicolumn{8}{c}{跨多列的标题}\\
%        %\cline{2-9}% partial hline from column i to column j
%        \hline
%        Row 1 & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$\\
%        \hline
%    \end{tabular}
%\end{apptab}
%
%
%\begin{apptab}[!htbp]
%    \bicaption{\enspace 这是一个样表}{\enspace This is a sample table}
%    \stepcounter{app_tab}
%    \label{apptab:2}
%    \centering
%    \footnotesize% fontsize
%    \setlength{\tabcolsep}{4pt}% column separation
%    \renewcommand{\arraystretch}{1.2}%row space 
%    \begin{tabular}{lcccccccc}
%        \hline
%        行号 & \multicolumn{8}{c}{跨多列的标题}\\
%        %\cline{2-9}% partial hline from column i to column j
%        \hline
%        Row 1 & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ & $7$ & $8$\\
%        \hline
%    \end{tabular}
%\end{apptab}
%
%附图测试
%
%\begin{appfig}[!htbp]
%    \centering
%    \includegraphics[width=0.40\textwidth]{c06h06}
%    \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%    \fignote{对图片的注释}
%    
%    \label{appfig:1}
%    \stepcounter{app_fig}
%\end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}


% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}

% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}
% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}
% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}
% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}
% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}
% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}
% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}
% \begin{appfig}[!htbp]
%     \centering
%     \includegraphics[width=0.40\textwidth]{c06h06}
%     \bicaption{\enspace 这是一个样图}{\enspace This is a sample figure}
%     \fignote{对图片的注释}
    
%     \label{appfig:1}
%     \stepcounter{app_fig}
% \end{appfig}


}

\renewcommand{\thealgorithm}{(附\arabic{algorithm})}
\chapter{附录中的算法}{
\setcounter{algorithm}{0}
	
	\begin{breakablealgorithm}
		\caption{位移变形}\label{alg:SH}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\Vector {l^{(i)}}$:采样点个数为$M$的第$i$条能量迹或电磁迹
			\Statex \textbf{输入:} $M^\prime$:合成的能量迹或电磁迹的采样点个数
			\Statex \textbf{输入:} $lb,ub$:模拟随机延迟的范围
			\Statex \textbf{输出:} $\Vector{l^\prime}$:采样点个数为$M^\prime$的新的能量迹或电磁迹
			\State $j\stackrel{\$}\gets \{lb,lb+1,lb+2,\dots,rb-1\}$
			\State $\Vector{l^\prime}:=\Vector {l^{(i)}}[j:j+M^\prime]$\Comment{获取索引从$j$到$j+M^\prime$的切片}
			\State \Return $\Vector{l^\prime}$
		\end{algorithmic}
	\end{breakablealgorithm}

	\begin{breakablealgorithm}
		\caption{添加删除变形}\label{alg:AR}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\Vector {l^{(i)}}$:采样点个数为$M$的第$i$条能量迹或电磁迹
			\Statex \textbf{输入:} $R$:需要添加或删除的采样点个数
			\Statex \textbf{输出:} $\Vector{l^\prime}$:合成的能量迹或电磁迹
			\State $\Vector{l^\prime}:=\Vector {l^{(i)}}$\Comment{拷贝副本}
			\For {$r:=0,\dots,R-1$}\Comment{随机$R$个位置添加采样点}
				\State $j\stackrel{\$}\gets \{0,1,\dots,M+r-1\}$
				\State $v:=\frac{l^\prime_j+l^\prime_{j+1}}2$
				\State 在$\Vector {l}^\prime$索引为$j$的位置插入值$v$\Comment{向量的分量个数增加}
			\EndFor
			\State $\mathcal A\stackrel{\$}\gets\left\lbrace \mathcal I\subset \{0,1,\dots,M+R-1\}:\vert\mathcal I\vert=M\right\rbrace $\Comment{随机$M$个位置保留采样点}
			\State $\{a_0,a_1,\dots,a_{M-1}\}=\mathcal A,a_0<a_1<\dots<a_{M-1}$
			\State $\Vector{l^\prime}=\begin{bmatrix} {l^\prime}_{a_0} & {l^\prime}_{a_1} & \ldots&{l^\prime}_{a_{M-1}} \end{bmatrix}$
			\State \Return $\Vector{l^\prime}$
		\end{algorithmic}
	\end{breakablealgorithm}

	\begin{breakablealgorithm}
		\caption{循环位移变形}\label{alg:RO}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $L$:$T$条采样点个数为$M$的能量迹或电磁迹
			\Statex \textbf{输入:} $\gamma$:最大平移率
			\Statex \textbf{输入:} $C$:数据增强数量的比例
			\Statex \textbf{输出:} $L^{agmt}$:合成的共$(1+\gamma C)T$条能量迹或电磁迹
			\State $L^{agmt}:=L$\Comment{拷贝副本}
			\For {$i:=0,\dots,T-1$}
				\For {$r:=0,\dots,\gamma C-1$}
					\State $j\stackrel{\$}\gets \{-\gamma M,-\gamma M+1,\dots,\gamma M-1,\gamma M\}$
					\State 将$\Vector l^{(i)}$循环移动$j$个采样点得到$\Vector l^\prime$
					\State 将$\Vector l^\prime$加入到$L^{agmt}$中
				\EndFor
			\EndFor
			\State \Return $L^{agmt}$
		\end{algorithmic}
	\end{breakablealgorithm}
	
	\begin{breakablealgorithm}
		\caption{合成少数类过采样法}\label{alg:smotepolulate}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $L$:$T$条采样点个数为$M$的能量迹或电磁迹
			\Statex \textbf{输入:} $\mathcal I_y$:对应中间值为$y$能量迹或电磁迹的索引
			\Statex \textbf{输入:} $n$:最近点的个数
			\Statex \textbf{输入:} $C$:数据增强数量的比例
			\Statex \textbf{输出:} $L^{agmt}$:合成的共$C\vert\mathcal I_y\vert$条中间值为$y$能量迹或电磁迹
			\State $L^{agmt}:=[]$\Comment{初始化为空列表}
			\If{$C<1$}
				\State $\mathcal I\stackrel{\$}\gets\{\mathcal A\subset \mathcal I_y:\vert\mathcal A\vert=C\vert\mathcal I_y\vert\}$\Comment{随机保留比例为$C$的集合元素}
				\State $C:=1$
			\Else
				\State $\mathcal I:=\mathcal I_y$
				\State $C:=\lfloor C\rfloor$
			\EndIf
			\For {$i\in \mathcal I$}
				\State 计算中间值为$y$的能量迹或电磁迹中距离$\Vector {l^{(i)}}$最近的$n$条能量迹或电磁迹的索引，索引集合记为$\mathcal J$
				\For{$c:=0,\dots,C-1$}\Comment{每条能量迹或电磁迹会合成$C$条新的能量迹或电磁迹}
					\State $j\stackrel{\$}\gets\mathcal J$
					\For {$m:=0,\dots M-1$}
						\State $\lambda\stackrel{\$}\gets U(0,1)$\Comment{从均匀分布中采样}
						\State $l^\prime_m:=\lambda l^{(i)}_m+(1-\lambda)l^{(j)}_m$
					\EndFor
					\State 将$\Vector l^\prime$加入到$L^{agmt}$中
				\EndFor
			\EndFor
			\State \Return $L^{agmt}$
		\end{algorithmic}
	\end{breakablealgorithm}
	
	\begin{breakablealgorithm}
		\caption{验签操作的数乘算法}\label{alg:verifyscalar}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\left\{\tilde{\multiplier}_0,\tilde{\multiplier}_1,\dots,\tilde{\multiplier}_i,\dots, \tilde{\multiplier}_{cl-1}\right\}$:数乘倍数$\multiplier$的长度为$cl$的编码形式
			\Statex \textbf{输入:} $P_1,P_2,P_3$:预计算的椭圆曲线$E$上的点
			\Statex \textbf{输出:} $\multiplier\cdot P$:点$P$与数乘倍数$\multiplier$数乘的结果
			\State $S:=\mathcal O$\Comment{初始化为无穷远点$\mathcal O$,导致$S:=2\cdot S$存在时间泄漏}
			\For{$j:=0,\dots , l-1$}
			\If {$\tilde \multiplier_j>0$}
			\State break
			\EndIf
			\EndFor
			\For{$i:=j,\dots , l-1$}\Comment{时间泄漏}
			\State $S:=2\cdot S$
			\If {$\tilde \multiplier_i>0$}\Comment{时间泄漏}
			\State $\leakedmultiplier_i:=\tilde \multiplier_i$
			\State $S:=S+P_{\leakedmultiplier_i}$\Comment{$\leakedmultiplier_i$存在泄漏}
			\EndIf
			\EndFor
			\State \Return $S$
		\end{algorithmic}
	\end{breakablealgorithm}
	
	\begin{breakablealgorithm}
		\caption{签名操作的数乘算法}\label{alg:signscalar}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\left\{\tilde{\nonce}_0,\tilde{\nonce}_1,\dots,\tilde{\nonce}_j,\dots, \tilde{\nonce}_{128}\right\}$:一次性随机数$\nonce$的长度为129的编码形式
			\Statex \textbf{输入:} $G_0,G_1,G_2,G_3,G_4$:预计算的椭圆曲线$E$上的点
			\Statex \textbf{输出:} $\nonce\cdot G$:基点$G$与一次性随机数$\nonce$数乘的结果
			\State $S:=G_1$
			\For{$j:=1,\dots , 128$}
			\State $S:=2\cdot S$
			\If {$\tilde \nonce_j>0$}
			\State $\leakedmultiplier_j:=\tilde \nonce_j$
			\State $S:=S+G_{\leakedmultiplier_j}$\Comment{$\leakedmultiplier_j$存在泄漏}
			\Else
			\State $\leakedmultiplier_j:=\tilde \nonce_j$
			\State $Dummy:=S+G_{\leakedmultiplier_j}$\Comment{$\leakedmultiplier_j$存在泄漏}
			\EndIf
			\EndFor
			\If {$\tilde \nonce_0=0$}
			\State $S:=S-G_4$
			\Else
			\State $Dummy:=S-G_4$
			\EndIf
			\State \Return S
		\end{algorithmic}
	\end{breakablealgorithm}

	\begin{breakablealgorithm}
		\caption{分块方差}\label{alg:calcvar}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\Vector{l}^{(i)}$:采样点个数为$M$的电磁迹
			\Statex \textbf{输入:} $w_d$:分块大小
			\Statex \textbf{输出:} $\Vector D$分块后每块的方差
			\For {$j:=0\dots\left\lfloor\frac{M}{w_d}\right\rfloor-1$}
			\State $d_i:=\mathrm{Var}(l^{(i)}_{jw_d},l^{(i)}_{jw_d+1},\dots,l^{(i)}_{jw_d+w_d-1})$
			\EndFor
			\State \Return $\left\{d_0,d_1,\dots,d_{\left\lfloor\frac{M}{w_d}\right\rfloor-1}\right\}$
		\end{algorithmic}
	\end{breakablealgorithm}
	
	\begin{breakablealgorithm}
		\caption{模数转换}\label{alg:quantize}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\Vector X$:采样点个数为$N_X$的数列
			\Statex \textbf{输入:} $th$:模数转换的阈值
			\Statex \textbf{输出:} $\Vector Q$模数转换后的数列
			\For {$i:=0\dots N_X-1$}
			\If{$x_i<th$}
			\State $q_i:=0$
			\Else
			\State $q_i:=1$
			\EndIf
			\EndFor
			\State \Return $\left\{q_0,q_1,\dots,q_{N_X-1}\right\}$
		\end{algorithmic}
	\end{breakablealgorithm}

	\begin{breakablealgorithm}
		\caption{去抖动}\label{alg:antijitter}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\Vector X$:采样点个数为$N_X$的01数列
			\Statex \textbf{输入:} $w_a$:去抖动窗口大小
			\Statex \textbf{输出:} $\Vector A$去抖动后的数列
			\State $s:=0$\Comment{初始状态需要设置为常数，可以是0，也可以是1}
			\State $b:=0$
			\For {$i:=0\dots N_X-1$}
			\State $b:=(b\cdot2+x_i)\bmod 2^{w_a}$
			\If{$b=0$}
			\State $s:=0$\Comment{连续$w_a$比特0需要重置状态为0}
			\ElsIf {$b=2^{w_a}-1$}
			\State $s:=1$\Comment{连续$w_a$比特1需要设置状态为1}
			\EndIf
			\State $a_i:=s$
			\EndFor
			\State \Return $\begin{bmatrix}a_0&a_1&\ldots&a_{N_X-1}\end{bmatrix}$
		\end{algorithmic}
	\end{breakablealgorithm}

	\begin{breakablealgorithm}
		\caption{模糊}\label{alg:gaussblur}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\Vector X$:采样点个数为$N_X$的数列（下标范围之外的数值为0）
			\Statex \textbf{输入:} $w_g$:高斯模糊的窗口大小的一半（下取整）
			\Statex \textbf{输出:} $\Vector G$高斯模糊的数列
			\For {$i:=0\dots 2w_g$}
			\State $c_i:=\begin{pmatrix}
			2w_g\\
			i
			\end{pmatrix}$\Comment{组合数}
			\EndFor
			\State $Kernel:=2^{-2w_g}\begin{bmatrix}c_0&c_1&\ldots&c_{2w_g}\end{bmatrix}$\Comment{计算卷积核}
			\State $\Vector G=Kernel*X$\Comment{卷积}
			%			\For {$i:=0\dots N_X-1$}
			%			\State $g_i:=K\cdot [x_{i-w_g},x_{i-w_g+1},\dots,x_{i+w_g-1},x_{i+w_g}]$
			%			\EndFor
			\State \Return $G$%$\left\{g_0,g_1,\dots,g_{N_X-1}\right\}$
		\end{algorithmic}
	\end{breakablealgorithm}

	
	\begin{breakablealgorithm}
		\caption{前$m$极值点}\label{alg:maxpoint}
		\begin{algorithmic}[1]
			\Statex \textbf{输入:} $\Vector X$:采样点个数为$N_X$的数列
			\Statex \textbf{输入:} $m$:需要选出的极值点个数
			\Statex \textbf{输入:} $th$:可接受的极值点之间的最小距离
			\Statex \textbf{输出:} $\mathcal M$:前$m$大极值的极值点的集合
			\For {$i:=0\dots N_X-1$}
			\State $p_i:=(\vert x_i\vert,i)$\Comment{生成数值、索引对}
			\EndFor
			\State $Pair:=\begin{bmatrix}p_0&p_1&\ldots&p_{N_X-1}\end{bmatrix}$
			\State $\mathrm{sort}(Pair)$\Comment{以数值索引对中的数值作为关键字，降序排序}
			\State $\mathcal M:=\{\}$
			\For{$i:=0,\dots,N_X$}
			\State $p^\prime=Pair[i].second$\Comment{取第二个分量（索引）}
			\If{$\forall pos\in \mathcal M,\vert pos-p^\prime\vert\ge th$}
			\State $\mathcal M:=\mathcal M\cup\{p^\prime\}$
			\If {$\left\vert\mathcal M\right\vert=m$}
			\State break
			\EndIf
			\EndIf
			\EndFor
			\If {$\left\vert\mathcal M\right\vert=m$}
			\State \Return $\mathcal M$
			\Else
			\State \Return $\phi$
			\EndIf
		\end{algorithmic}
	\end{breakablealgorithm}
}